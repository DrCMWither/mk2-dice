<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/dice.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/dice.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Roll n dice with m sides each.
 *
 * @param {number} n - Number of dice to roll.
 * @param {number} m - Number of sides on each die (must be \geq 1).
 * @returns {number[]} Array of length n with each die result (1â€“m).
 */
export function rollDice(n, m) {
    const rolls = [];
    for (let i = 0; i &lt; n; i++) {
        rolls.push(Math.floor(Math.random() * m) + 1);
    }
    return rolls;
}

/**
 * Parse the expression of a dice (e.g., "3d6*2+5").
 * @param {string} expr - The expression of the dice.
 * @returns {object | null} Parse result or null
 */
export function parseDiceExpression(expr) {
    expr = expr.trim();
    const full = /^(\d+)#\(?(.+?)\)?$/;
    const match = expr.match(full);
    if (match) {
        const repeat = parseInt(match[1], 10);
        const innerExpr = match[2].trim();
        const parsedInner = parseDiceExpression(innerExpr);
        if (!parsedInner) return null;
        return { ...parsedInner, repeat };
    }

    // Handle constants (reqd. by @function )
    if (/^\d+$/.test(expr)) {
        const val = parseInt(expr, 10);
        return { count: 0, sides: 0, multiplier: 1, modifier: val, repeat: 1 };
    }

    const pattern = /^(\d*)d(\d+)(?:\*(\d+))?([+-]\d+)?$/i;
    const parts = expr.match(pattern);
    if (!parts) return null;

    const count      = parts[1] ? parseInt(parts[1], 10) : 1;
    const sides      = parseInt(parts[2], 10);
    const multiplier = parts[3] ? parseInt(parts[3], 10) : 1;
    const modifier   = parts[4] ? parseInt(parts[4], 10) : 0;

    if (sides &lt; 1 || count &lt; 1) return null;

    return { count, sides, multiplier, modifier, repeat: 1 };
}

/**
 * Fetches quantum random numbers from the ANU Quantum Random Number Generator API.
 *
 * @param {number} totalCount - The total number of random numbers to generate (max 1000 per request).
 * @param {number} sides - The number of sides for the dice (determines the range [1, sides]).
 * @returns {number[]} An array of `totalCount` random integers, each in the range [1, sides].
 * @throws {Error} If the API request fails or returns invalid data.
 *
 * @example
 * // Get 5 dice rolls for a 6-sided die
 * const rolls = await getQuantumRandomNumbers(5, 6);
 * // Returns: [3, 1, 5, 2, 6] (example output)
 */
export async function getQuantumRandomNumbers(totalCount, sides) {
    const response = await fetch(`https://qrng.anu.edu.au/API/jsonI.php?length=${totalCount}&amp;type=uint8&amp;size=${sides}`);
    const data = await response.json();
    return data.data.slice(0, totalCount).map(num => (num % sides) + 1);
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#bestDiscard">bestDiscard</a></li><li><a href="global.html#clearAllAttributes">clearAllAttributes</a></li><li><a href="global.html#clearAttributes">clearAttributes</a></li><li><a href="global.html#computeWeights">computeWeights</a></li><li><a href="global.html#countMentsu">countMentsu</a></li><li><a href="global.html#countTiles">countTiles</a></li><li><a href="global.html#deleteAttribute">deleteAttribute</a></li><li><a href="global.html#drawTiles">drawTiles</a></li><li><a href="global.html#escapeHtml">escapeHtml</a></li><li><a href="global.html#gammaSample">gammaSample</a></li><li><a href="global.html#gaussian">gaussian</a></li><li><a href="global.html#generateAdvancedProblem">generateAdvancedProblem</a></li><li><a href="global.html#generateDora">generateDora</a></li><li><a href="global.html#generateProblem">generateProblem</a></li><li><a href="global.html#getAllAttributes">getAllAttributes</a></li><li><a href="global.html#getAttributes">getAttributes</a></li><li><a href="global.html#getInsanity">getInsanity</a></li><li><a href="global.html#getQuantumRandomNumbers">getQuantumRandomNumbers</a></li><li><a href="global.html#getSynonyms">getSynonyms</a></li><li><a href="global.html#handToUnicode">handToUnicode</a></li><li><a href="global.html#handleDraw">handleDraw</a></li><li><a href="global.html#handleGetst">handleGetst</a></li><li><a href="global.html#handleInsanity">handleInsanity</a></li><li><a href="global.html#handleLi">handleLi</a></li><li><a href="global.html#handleMessage">handleMessage</a></li><li><a href="global.html#handleName">handleName</a></li><li><a href="global.html#handleNnkr">handleNnkr</a></li><li><a href="global.html#handleRa">handleRa</a></li><li><a href="global.html#handleRoll">handleRoll</a></li><li><a href="global.html#handleSc">handleSc</a></li><li><a href="global.html#handleSt">handleSt</a></li><li><a href="global.html#handleSynonyms">handleSynonyms</a></li><li><a href="global.html#handleTi">handleTi</a></li><li><a href="global.html#improvementCount">improvementCount</a></li><li><a href="global.html#jrrp">jrrp</a></li><li><a href="global.html#nextTile">nextTile</a></li><li><a href="global.html#normalizeKey">normalizeKey</a></li><li><a href="global.html#parseDiceExpression">parseDiceExpression</a></li><li><a href="global.html#randomHand">randomHand</a></li><li><a href="global.html#randomTile">randomTile</a></li><li><a href="global.html#rollDice">rollDice</a></li><li><a href="global.html#setAttribute">setAttribute</a></li><li><a href="global.html#shantenNormal">shantenNormal</a></li><li><a href="global.html#shuffle">shuffle</a></li><li><a href="global.html#sortHand">sortHand</a></li><li><a href="global.html#splitAttributes">splitAttributes</a></li><li><a href="global.html#tileToUnicode">tileToUnicode</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Thu Nov 13 2025 21:20:12 GMT+0800 (China Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
